!function(e){e.module("dhisHighchartAngularService.config",[]).value("dhisHighchartAngularService.config",{debug:!0}),e.module("dhisHighchartAngularService.directives",[]),e.module("dhisHighchartAngularService.filters",[]),e.module("dhisHighchartAngularService.services",["chartServices"]),e.module("dhisHighchartAngularService",["dhisHighchartAngularService.config","dhisHighchartAngularService.directives","dhisHighchartAngularService.filters","dhisHighchartAngularService.services","ngResource","ngCookies","ngSanitize"])}(angular);var chartServices=angular.module("chartServices",["ngResource"]);chartServices.factory("chartsManager",function(){"use strict";var e={data:"",defaultChartObject:{title:{text:""},xAxis:{categories:[],labels:{rotation:-90,style:{color:"#000000",fontWeight:"normal"}}},yAxis:{min:0,title:{text:""},labels:{style:{color:"#000000",fontWeight:"bold"}}},labels:{items:[{html:"",style:{left:"50px",top:"18px"}}]},series:[]},getTitleIndex:function(e,a){var t=0,r=0;return angular.forEach(e,function(e){e.name===a&&(t=r),r++}),t},getValueIndex:function(e){var a=-1;return angular.forEach(e,function(){a++}),a},getMetadataArray:function(e,a){var t=this.getTitleIndex(e.headers,a),r=[],i=[];return"dx"===a||"value"===a?angular.forEach(e.rows,function(e){-1===i.indexOf(e[t])&&(r.push(e[t]),i.push(e[t]))}):r="ou"===a?e.metaData.ou:"co"===a?e.metaData.co:"pe"===a?e.metaData.pe:e.metaData.co,r},prepareCategories:function(e,a,t){var r={xAxisItems:[],yAxisItems:[]};return angular.forEach(this.getMetadataArray(e,t),function(a){r.yAxisItems.push({name:e.metaData.names[a],uid:a})}),angular.forEach(this.getMetadataArray(e,a),function(a){r.xAxisItems.push({name:e.metaData.names[a],uid:a})}),r},getDataValue:function(e,a,t,r,i,n,s){var u=0,h=this;return $.each(e.rows,function(c,l){"none"===n?l[h.getTitleIndex(e.headers,r)]===i&&l[h.getTitleIndex(e.headers,a)]===t&&(u=parseFloat(l[h.getTitleIndex(e.headers,"value")])):l[h.getTitleIndex(e.headers,r)]===i&&l[h.getTitleIndex(e.headers,a)]===t&&l[h.getTitleIndex(e.headers,n)]===s&&(u=parseFloat(l[h.getTitleIndex(e.headers,"value")]))}),u},drawChart:function(){},drawPieChart:function(e,a,t,r,i,n){var s=angular.copy(this.defaultChartObject);s.title.text=n;var u=[],h=this.prepareCategories(e,a,t),c=this;return angular.forEach(h.yAxisItems,function(n){angular.forEach(h.xAxisItems,function(s){var h=c.getDataValue(e,a,s.uid,t,n.uid,r,i);u.push({name:n.name+" - "+s.name,y:parseFloat(h)})})}),s.series={type:"pie",name:n,data:u,showInLegend:!0,dataLabels:{enabled:!1}},s},drawCombinedChart:function(e,a,t,r,i,n){var s=angular.copy(this.defaultChartObject);s.title.text=n;var u=[],h=this.prepareCategories(e,a,t),c=this;return angular.forEach(h.yAxisItems,function(n){var l=[];angular.forEach(h.xAxisItems,function(s){var h=c.getDataValue(e,a,s.uid,t,n.uid,r,i);l.push(parseFloat(h)),u.push({name:n.name+" - "+s.name,y:parseFloat(h)})}),s.series.push({type:"column",name:n.name,data:l}),s.series.push({type:"spline",name:n.name,data:l})}),s.series.push({type:"pie",name:n,data:u,center:[100,80],size:150,showInLegend:!1,dataLabels:{enabled:!1}}),s},drawOtherCharts:function(e,a,t,r,i,n,s){var u=angular.copy(this.defaultChartObject);u.title.text=n;var h=this.prepareCategories(e,a,t),c=this;return angular.forEach(h.yAxisItems,function(n){var l=[];angular.forEach(h.xAxisItems,function(s){var u=c.getDataValue(e,a,s.uid,t,n.uid,r,i);l.push(parseFloat(u))}),u.series.push({type:s,name:n.name,data:l})}),u}};return e});